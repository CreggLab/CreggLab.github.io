{% if include.lookup %}
  {% assign citation = site.publications | where_exp: "item", "item.title == include.lookup or item.paperurl == include.lookup" | first %}
{% else %}
  {% assign citation = include %}
{% endif %}

<div class="citation">
  {% if include.style == "rich" %}
    <a
      {% if citation.paperurl %}
        href="{{ citation.paperurl | relative_url }}"
      {% endif %}
      class="citation-image"
      aria-label="{{ citation.title | default: "citation link" }}"
    >
      {% if citation.image %}
        <img
          src="{{ citation.image | relative_url }}"
          alt="{{ citation.title | default: "citation image" }}"
          loading="lazy"
        >
      {% endif %}
    </a>
  {% endif %}

  <div class="citation-text">
    <div class="citation-title">{{ citation.title | default: "[no title info]" }}</div>

    <div class="citation-authors">
      {{ citation.authafter | prepend: ", " | default: "[no author info]" }}
    </div>

    <div class="citation-details">
      {{ citation.venue | default: "[no venue info]" }}
      &nbsp; Â· &nbsp;
      {{ citation.date | default: "[no date info]" | date: "%d %b %Y" }}
    </div>

    {% if include.style == "rich" %}
      {% if citation.special2 %}
        <div class="citation-description">
          {{ citation.special2 | markdownify }}
        </div>
      {% endif %}

      {% if citation.pdf %}
        <div class="citation-buttons">
          <a href="{{ citation.pdf }}" target="_blank" class="button">PDF</a>
        </div>
      {% endif %}
    {% endif %}
  </div>
</div>
